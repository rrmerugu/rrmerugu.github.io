<!DOCTYPE html>
<html lang="en-us">

  o<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Introducing hyde &middot; Ravi Raja Merugu
    
  </title>

  <!-- CSS 474588-->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:300,300italic,400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="/public/css/font-awesome-animations.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet"/>

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
<p style="margin-left:30px">
      <i class="fa fa-circle-o faa-burst animated magic-icon"></i></p>
      <h1>
        <a href="/">
          Ravi Raja Merugu
        </a>
      </h1>
      <p class="lead">Computational Biologist and Web Technologist</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Home</a>

      

      
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/about/">About</a>
          
        
      
        
      
        
          
        
      
        
      
        
      

      <!-- <a class="sidebar-nav-item" href="https://github.com/rsquarelabs/rsquarelabs/archive/v2.1.0.zip">Download</a> -->
      <!-- <a class="sidebar-nav-item" href="https://github.com/rsquarelabs/rsquarelabs">GitHub project</a> -->
      <!-- <span class="sidebar-nav-item">Currently v2.1.0</span> -->
    </nav>

    <p class="small">&copy; 2016. Built
       with <i class="fa fa-heart"></i> for Science and Code.  </p>
  </div>
</div>


    <div class="content container">
      <div class="post">
  <h1 class="post-title">Introducing hyde</h1>
  <span class="post-date">28 Dec 2013</span>
  <p>Today I learned how to use <code class="highlighter-rouge">git add -p</code> (short for <code class="highlighter-rouge">git add --patch</code>) to make smaller, cleaner, more isolated git commits. My life is changed.</p>

<!--/excerpt-->

<h2 id="when-to-use-it">When to use it</h2>

<p>Let me paint you a picture…</p>

<p>I’m working on a really fun project (the <a href="https://github.com/vakila/kimi">Kimi</a> interpreter), and am so in the zone that I forget to commit for a couple of hours.
During that time I make a bunch of different changes to a certain file, <code class="highlighter-rouge">kimi.py</code>, and some of those changes don’t have anything to do with one another conceptually, i.e. relate to different features/bugfixes.</p>

<p>At this point, if I stage all my changes with <code class="highlighter-rouge">git add kimi.py</code>, I’ll have a commit which globs together all the different things I did.</p>

<p><img src="https://imgs.xkcd.com/comics/git_commit.png" alt="'Git Commit' on XKCD" />
<em><a href="https://imgs.xkcd.com/comics/git_commit.png">XKCD</a> knows my pain</em></p>

<p>So what?</p>

<p>Well, if later on, after committing, I decide that most of the changes in that commit were useful, but one was a real fuck-up and I want to revert the commit, I’d have to manually go back and redo all of my other changes.
That sounds like a pain in the ass, no?</p>

<p>But wait! The <code class="highlighter-rouge">--patch</code> flag to the rescue!</p>

<h2 id="how-it-works">How it works</h2>

<p>If I run <code class="highlighter-rouge">git add --patch kimi.py</code> or <code class="highlighter-rouge">git add -p kimi.py</code> instead of the regular <code class="highlighter-rouge">git add kimi.py</code>, git divides the edits I’ve made into separate “hunks”, and launches a nice little interactive interface which lets me pick and choose which hunks to stage for the next commit. It presents the hunks one-by-one in the order they appear in the file, and gives me the following options for each hunk:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>y - stage this hunk
n - do not stage this hunk
q - quit; do not stage this hunk or any of the remaining ones
a - stage this hunk and all later hunks in the file
d - do not stage this hunk or any of the later hunks in the file
g - select a hunk to go to
/ - search for a hunk matching the given regex
j - leave this hunk undecided, see next undecided hunk
J - leave this hunk undecided, see next hunk
k - leave this hunk undecided, see previous undecided hunk
K - leave this hunk undecided, see previous hunk
s - split the current hunk into smaller hunks
e - manually edit the current hunk
? - print help
</code></pre>
</div>

<p>This allows me to make separate commits for the different parts of the file I edited, so that each commit is conceptually independent of the others. Now, if I later decide that one of those hunks was a mistake, I can simply revert that commit, and all of my other changes remain in place.</p>

<p>If I want to make sure I’ve staged the right hunks, I can run <code class="highlighter-rouge">git diff --staged</code> to see exactly which changes are staged before making the commit.</p>

<p>It’s not perfect; for example, it’s only aware of position in the code, so it can’t distinguish two conceptually different changes that are right next to each other, as in:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>- this is an old line I deleted
+ (topic 1) this is a new line I added
+ (topic 1) this is another line related to the one above
+ (topic 2) this is a new line related to a different topic
</code></pre>
</div>

<p>…but that would be expecting too much.</p>

<p>In any case, you shouldn’t be using <code class="highlighter-rouge">--patch</code> as an excuse to be more lazy about your committing habits. <strong>Commit early, commit often, and work on one thing at a time.</strong> But in those <em>rare</em> (ahem) cases  where for whatever reason you got behind on your git organization, <code class="highlighter-rouge">--patch</code> is your friend!</p>

<hr />
<p><em>Sources:</em></p>

<ul>
  <li><a href="http://stackoverflow.com/questions/1085162/commit-only-part-of-a-file-in-git">Commit only part of a file in Git</a> on StackOverflow</li>
  <li>Info from typing <code class="highlighter-rouge">help</code> while in the <code class="highlighter-rouge">git add -p file.ext</code> dialog</li>
</ul>

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/blog/example-content/">
            Example content
            <small>07 Feb 2012</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/blog/whats-jekyll/">
            What's Jekyll?
            <small>06 Feb 2012</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

    </div>

  </body>
</html>
